# 架构说明

> Version: 1.0
> Date: 2020-12-30     
> Author: MeteorCat

这里需要解释说明 `aqara` 的整体架构, 官网内部局域网功能提供以下 `API`:
* 设备通知和发现
* 设备状态上报
* 设备读写操作
* 设备心跳包管理

而加密方式基于 `AES-CBC-128` 且无填充的 `16` 字节长度为主的字符串之后解析为 `32` 长度的 `ASCII` 数据, 具体加密流程可以参照 `src/builder.rs` 内部实现.

比较需要说明的是数据交换都是基于 `UDP` 的两种方式:
* UDP 组播
* UDP 单播

如果刚开始接触需要区分好组播, 单播和广播的区分:
* 单播: 内网之中单对单主机的通讯, 基于 UDP 报文协议可以交互两台主机数据.
* 广播: 内网之中单对所有 (注意:`所有`) 可能存在的主机发送报文.
* 组播: 内网之中单对指定组的主机进行报文发送, 而不会直接广播所有内网主机.

内部实现可以参考 `src/session.rs`
